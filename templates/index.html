<!DOCTYPE html>
<html>

<head>
    <meta charset="UTF-8" />
    <link rel="stylesheet" href="../static/CSS/Style.css" />
    <link href="https://fonts.googleapis.com/css?family=Lobster" rel="stylesheet" />
    <link rel="shortcut icon" type="image/x-icon" href="../static/Images/bucket-list.png" />
    <script src="../static/JS/jquery-2.2.3.js"></script>
    <script src="../static/JS/jquery.matchHeight.js"></script>
    <title> Bucket List </title>
</head>

<body>
    <nav>
        <div id="navList">
            <div class="left">
                <h2 class="h2">
                    A place to share your dreams and wishes
                </h2>
            </div>
            <div class="right">
                <ul class="ul">
                    <li id="loginBtn" class="options"> Log In </li>
                    <li id="signUpBtn" class="options"> Sign Up </li>
                </ul>
            </div>
        </div>
    </nav>
    <div id="loginModal" class="modal">
        <form class="modal-content" action="{{url_for('login')}}" method="POST">
            <span class="close" id="loginClose">x</span>
            <br> <br>
            <input type="text" name="userName" placeholder="Enter username..." required class="coolInput" />
            <br>
            <input type="password" name="passWord" placeholder="Enter password..." required class="coolInput" />
            <br>
            <div class="flashMessage" id="loginMessage">
                {{get_flashed_messages(category_filter=["login"])[0]}}
            </div>
            <br>
            <button type="submit" class="btn"> Login In </button>
        </form>
    </div>
    <div id="signUpModal" class="modal">
        <form class="modal-content" action="{{url_for('register')}}" method="POST" enctype="multipart/form-data" id="registerForm">
            <span class="close" id="signUpClose">x</span>
            <br> <br>
            <input type="text" name="userName" placeholder="Enter username..." required class="coolInput" />
            <br>
            <input type="text" name="userQuote" placeholder="Enter your quote here..." required class="coolInput" />
            <br>
            <input type="text" readonly class="coolInput" style="margin-right: 10px" id="picName" />
            <span class="coolInput" onclick="inputClick()"> 
                    Click here to select profile image...
                </span>
            <input type="file" style="display: none" id="picSelect" name="file" accept="image/*" required onchange="displayName(files)">
            <br>
            <input type="password" name="passWord" placeholder="Enter password..." required id="firstPass" class="coolInput" />
            <br>
            <input type="password" name="rePass" placeholder="Re-Enter password..." required id="secondPass" class="coolInput" />
            <br>
            <div class="flashMessage" id="flashMessage">
                {{get_flashed_messages(category_filter=["signup"])[0]}}
            </div>
            <br>
            <span id="submitButton" class="btn" onclick="submitForm()"> Sign Up </span>
        </form>
    </div>
    <div id="container">
        <div id="aboutUs">
            <h3>
                We take care of the crazy stuff so you can pour you heart into your words and tell it to the world.
            </h3>
        </div>
        <div id="feedId">
            Here are some popular lists to inspire you to wish more and make them come true...
        </div>
        <div id="popularFeeds">
            <div id="itemCount" style="display: none">{{valueCount}}</div>
            <div id="emptyMessage" style="display: none">
                <img src="../static/Images/EmptyToDo.jpg" />
                <br> <br> There's nothing to show right now. I'm sorry but we just started...
            </div>
            <div id="feedHolder">
                {% for i in range(0, valueCount|int) %} {% if i % 3 == 0 %}
                <div class="col span" style="height: 425px; margin: 1% 0; cursor: pointer" onclick="displayAll(event)">
                    <img src="http://localhost:5000/images/{{result[i]['picture']}}" width="100%" />
                    <h1 style="padding: 0; margin: 10px 0">
                        {{result[i]['userName']}}
                    </h1>
                    <span style="font-size: 2em; color: purple">{{result[i]['name']}}</span>
                    <div style="margin: 10px 0">
                        {{result[i]['date']}}
                    </div>
                    <div class="hidden">
                        {{result[i]['tags']}}
                    </div>
                    <span class="hidden">
                                    {{result[i]['dateDiff']}}
                    </span>
                </div>
                {% else %}
                <div class="col span" style="height: 425px; cursor: pointer" onclick="displayAll(event)">
                    <img src="http://localhost:5000/images/{{result[i]['picture']}}" width="100%" />
                    <h1 style="padding: 0; margin: 10px 0">
                        {{result[i]['userName']}}
                    </h1>
                    <span style="font-size: 2em; color: purple">{{result[i]['name']}}</span>
                    <div style="margin: 10px 0">
                        {{result[i]['date']}}
                    </div>
                    <div class="hidden">
                        {{result[i]['tags']}}
                    </div>
                    <span class="hidden">
                                    {{result[i]['dateDiff']}}
                    </span>
                </div>
                {% endif %} {% endfor %}
            </div>
        </div>
        <div class="footer">
            <div class="left">
                <span class="endFooter"> Connect With Us: </span>
                <ul class="ul" style="float: none">
                    <li class="link"> Lorem Ipsum </li>
                    <li class="link"> Lorem Ipsum </li>
                    <li class="link"> Lorem Ipsum </li>
                </ul>
            </div>
            <div class="right">
                <span class="endFooter"> About Us: </span>
                <br>
                <span class="endFooter" style="color: purple">
                        We just want to make a way for you to remember your wishes and let others know about it as well.
                    </span>
            </div>
        </div>
        <div class="footer" id="footer">
            Made and Designed by Rudrangshu Nandi
        </div>
    </div>
    <script>
            function displayName(files){
                var fileName = files[0].name;
                document.querySelector("#picName").value = fileName;
            }

            function submitForm(){
                var submit = true;
                var mainPass = document.querySelector("#firstPass").value.trim();
                var rePass = document.querySelector("#secondPass").value.trim();
                var userPic = document.querySelector("#picName").value.trim();
                var userQuote = document.getElementsByName("userQuote")[0].value.trim();
                var userName = document.getElementsByName("userName")[1].value.trim();
                if(mainPass === "" || rePass === "" || userPic === "" || userQuote === "" || userName === "")
                    submit = false;
                if(submit)
                    document.querySelector("#registerForm").submit();
                else
                    document.querySelector("#flashMessage").innerHTML = "Please fill all fields...";
            }
            var element = document.querySelector("#itemCount");
            var messageBox = document.querySelector("#emptyMessage");
            if (parseInt(element.innerHTML) === 0)
                messageBox.style.display = "block";
    </script>
    <script>
        jQuery(function($){
            $('.matchheight').matchHeight();
        });

        var modal_1 = $("#loginModal");
        var modal_2 = $("#signUpModal");
        var btn_1 = document.getElementById("loginBtn");
        var btn_2 = document.getElementById("signUpBtn");
        var span_1 = document.getElementById("loginClose");
        var span_2 = document.getElementById("signUpClose");
        var signUpMessage = document.querySelector("#flashMessage");
        var loginMessage = document.querySelector("#loginMessage");
        var input = document.querySelector("#picSelect");

        function inputClick(){
            input.click();
        }

        btn_1.onclick = function() {
            modal_1.fadeIn();
        }
        btn_2.onclick = function(){
            modal_2.fadeIn();
        }
        span_1.onclick = function() {
            modal_1.fadeOut();
        }
        span_2.onclick = function(){
            modal_2.fadeOut();
        }
        window.onclick = function(event) {
            if (event.target.id === "loginModal") {
                modal_1.fadeOut();
            }
            if(event.target.id === "signUpModal")
                modal_2.fadeOut();
        }

        $(document).ready(function(){
            if(signUpMessage.innerHTML.trim() !== "")
                modal_2.fadeIn();
            else if(loginMessage.innerHTML.trim() !== "")
                modal_1.fadeIn();
        });
    </script>

    <script>
			var firstPass = document.querySelector("#firstPass");
			var secondPass = document.querySelector("#secondPass");
			var message = document.querySelector("#flashMessage");
			var button = document.querySelector("#submitButton");

			$(document).ready(function(){
				button.disabled = true;
			});
			
			$('#firstPass').keyup(function(){
				if(firstPass.value === secondPass.value && firstPass.value !== "" && secondPass.value !== ""){
					message.innerHTML = "Passwords match";
					button.disabled = false;
				}
				else if(firstPass.value !== secondPass.value  && firstPass.value !== "" && secondPass.value !== ""){
					message.innerHTML = "Passwords do not match";
					button.disabled = true;
				}
			});

			$("#secondPass").keyup(function(){
				if(firstPass.value !== secondPass.value && firstPass.value !== "" && secondPass.value !== ""){
					message.innerHTML = "Passwords do not match";
					button.disabled = true;
				}
				else if(firstPass.value === secondPass.value  && firstPass.value !== "" && secondPass.value !== ""){
					message.innerHTML = "Passwords match";
					button.disabled = false;
				}
			});
	</script>
</body>

</html>